@using PenTester;
@using PenTester.Objects;
@model ReportTemplate

@{
    ViewBag.Title = "View Report";
}

<h2>View Report</h2>
@*this is where we would put the report information (name, company, meta-data)*@

<section id="hosts">
@foreach (ReportTemplate.Host h in Model.Hosts)
{
    <div class="IPHeader" onclick="togglePorts(@h.GetHashCode())"><h3>@h.IPAddress</h3> (@h.PortCount) Open Ports : (@h.ThreatCount) Threats @(h.OperatingSystem == null ? "" : " : " + h.OperatingSystem ) </div>
    <div id="@("ports" + h.GetHashCode())" class="Ports">
        <div>
            @foreach (ReportTemplate.Port p in h.OpenPorts.Where(p => p.ThreatLevel != "None"))
            {
                <dl>
                    <dt>@p.Number : @p.Protocol : @p.Tool</dt>
                    <dd>Severity: @p.Severity <br />
                        Threat Level: @p.ThreatLevel <br />
                        @p.Description
                    </dd>
                </dl>
            }
        </div>
        <div onclick="LowLevel(@h.GetHashCode())"><b>(@h.OpenPorts.Where(p => p.ThreatLevel == "None").Count()) Non-Threats </b></div>
        <div class="LowLevel" id="@("lowlevel" + h.GetHashCode())">
            @foreach (ReportTemplate.Port p in h.OpenPorts.Where(p => p.ThreatLevel == "None"))
            {
                <dl>
                    <dt>@p.Number : @p.Protocol : @p.Tool</dt>
                    <dd>Severity: @p.Severity <br />
                        Threat Level: @p.ThreatLevel <br />
                        @p.Description
                    </dd>
                </dl>
            }
        </div>
        <br />
    </div>
}
</section>

<script type="text/javascript">
    $(document).ready(function () {
        $(".Ports").hide();
        $(".LowLevel").hide();
    });

    function LowLevel(hash) {
        $("#lowlevel" + hash).toggle();
    }

    function togglePorts(hash) {
        $("#ports" + hash).toggle();
    }
</script>