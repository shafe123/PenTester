using System;
using System.Collections.Generic;
using System.Linq;
using System.Web;
using System.Xml.Serialization;

namespace PenTester.Objects
{
    public class ReportItem
    {
        [XmlAttribute("port")]
        public int port { get; set; }
        [XmlAttribute("svc_name")]
        public string ServiceName { get; set; }
        [XmlAttribute("protocol")]
        public string Protocol { get; set; }
        [XmlAttribute("severity")]
        public int Severity { get; set; }
        [XmlAttribute("pluginID")]
        public int PluginID { get; set; }
        [XmlAttribute("pluginName")]
        public string PluginName { get; set; }
        [XmlAttribute("pluginFamily")]
        public string PluginFamily { get; set; }

        [XmlElement("description")]
        public string Description { get; set; }
        [XmlElement("fname")]
        public string FName { get; set; }
        [XmlElement("plugin_modification_date")]
        public DateTime PluginModificationDate { get; set; }
        [XmlElement("plugin_publication_date")]
        public DateTime PluginPublicationDate { get; set; }
        [XmlElement("plugin_type")]
        public string PluginType { get; set; }
        [XmlElement("risk_factor")]
        public string RiskFactor { get; set; }
        [XmlElement("solution")]
        public string Solution { get; set; }
        [XmlElement("synopsis")]
        public string Synopsis { get; set; }
        [XmlElement("plugin_output")]
        public string PluginOutput { get; set; }
    }

    public class Tag
    {
        [XmlAttribute("name")]
        public string Name { get; set; }

        [XmlText()]
        public string Value { get; set; }
    }

    public class HostProperties
    {
        List<Tag> tags { get; set; }
    }

    public class ReportHost
    {
        [XmlAttribute("name")]
        public string Address { get; set; }

        [XmlElement("HostProperties")]
        public HostProperties Properties { get; set; }

        List<ReportItem> ReportItems { get; set; }
    }

    public class Report
    {
        [XmlAttribute("name")]
        public string ReportName { get; set; }

        public List<ReportHost> Hosts { get; set; }
    }

    [Serializable]
    [XmlRoot("NessusClientData_v2")]    
    public class NessusReport
    {
        public Report Report { get; set; }
    }
}